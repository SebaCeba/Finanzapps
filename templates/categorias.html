<!DOCTYPE html>
<html>
<head>
    <title>Gestionar Categorías</title>
</head>
<body>
    <h1>Gestionar Categorías</h1>

    <!-- Formulario para agregar categoría -->
    <h2>Agregar Categoría o Subcategoría</h2>
    <form action="{{ url_for('agregar_categoria') }}" method="post">
        <input type="text" name="nombre" placeholder="Nombre de la categoría" required>
        
        <select name="tipo" required>
            <option value="ingreso">Ingreso</option>
            <option value="gasto_fijo">Gasto Fijo</option>
            <option value="gasto_variable">Gasto Variable</option>
        </select>

        <select name="parent_id">
            <option value="">Sin categoría padre (Nivel principal)</option>
            {% for categoria in categorias %}
                <option value="{{ categoria.id }}">{{ categoria.nombre }}</option>
            {% endfor %}
        </select>
        
        <button type="submit">Agregar</button>
    </form>

    <!-- Listado de categorías y subcategorías -->
    <h2>Categorías Existentes</h2>
    <ul>
        {% for categoria in categorias %}
            <li>
                {{ categoria.nombre }} ({{ categoria.tipo }})
                <form action="{{ url_for('eliminar_categoria', id=categoria.id) }}" method="post" style="display:inline;">
                    <button type="submit">Eliminar</button>
                </form>
                <ul>
                    {% for subcategoria in subcategorias %}
                        {% if subcategoria.parent_id == categoria.id %}
                            <li>
                                {{ subcategoria.nombre }} (Subcategoría)
                                <form action="{{ url_for('eliminar_categoria', id=subcategoria.id) }}" method="post" style="display:inline;">
                                    <button type="submit">Eliminar</button>
                                </form>
                            </li>
                        {% endif %}
                    {% endfor %}
                </ul>
            </li>
        {% endfor %}
    </ul>
</body>
</html>
